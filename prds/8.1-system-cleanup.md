# PRD 8.1: System File Cleanup

## Overview
Remove system/hidden files from image directories before delivery.

## Deliverables
- `src/cleanup/system-cleanup.ts`

## Interface

```typescript
export interface CleanupResult {
  scanned: number;
  removed: number;
  failed: number;
  files: CleanupFile[];
  totalSize: number; // bytes freed
}

export interface CleanupFile {
  path: string;
  type: SystemFileType;
  size: number;
  removed: boolean;
  error?: string;
}

export type SystemFileType =
  | 'ds_store'
  | 'thumbs_db'
  | 'desktop_ini'
  | 'apple_double'
  | 'spotlight'
  | 'trash';

export interface CleanupOptions {
  dryRun?: boolean;
  recursive?: boolean;
  includeHidden?: boolean;
}

export async function scanSystemFiles(
  dirPath: string,
  options?: CleanupOptions
): Promise<CleanupFile[]>;

export async function removeSystemFiles(
  dirPath: string,
  options?: CleanupOptions
): Promise<CleanupResult>;
```

## System Files to Remove

```typescript
const SYSTEM_FILES = {
  // macOS
  '.DS_Store': 'ds_store',
  '._*': 'apple_double',           // AppleDouble files
  '.Spotlight-V100': 'spotlight',
  '.Trashes': 'trash',
  '.fseventsd': 'spotlight',

  // Windows
  'Thumbs.db': 'thumbs_db',
  'desktop.ini': 'desktop_ini',
  'ehthumbs.db': 'thumbs_db',

  // Common
  '.directory': 'desktop_ini'      // KDE
};
```

## Behavior

1. **Scan Mode** (default)
   - Find all system files
   - Report what would be removed
   - Show total size

2. **Remove Mode** (explicit)
   - Delete system files
   - Report results
   - Handle permission errors

## CLI Output

```
Scanning /archive/museum-project/...

Found 47 system files (2.3 MB):
  .DS_Store: 23 files (1.2 MB)
  ._* (AppleDouble): 24 files (1.1 MB)

Dry run - no files removed.
Run with --remove to delete these files.
```

## Safety

- Dry run by default
- Never remove image files
- Log all operations
- Handle permission errors gracefully

## Success Criteria
- [ ] Detect all common system files
- [ ] Dry run works
- [ ] Actual removal works
- [ ] Handles permissions
- [ ] Recursive scanning
- [ ] Unit tests

## Dependencies
- PRD 1.1 (project setup)
